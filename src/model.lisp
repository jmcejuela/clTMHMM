;; Author: Juan Miguel Cejuela
;; Created: Wed Jul  9 19:59:50 2008 (CEST)
;; Last-Updated: 2011-08-11
;;     Update #: 15

(in-package :cltmhmm)

(declaim (optimize (speed 0) (safety 3) (compilation-speed 0) (debug 3)))
#+sbcl (declaim (sb-ext:muffle-conditions sb-ext:compiler-note))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(eval-when (:compile-toplevel :load-toplevel :execute)
  (defconstant +membrane-labell+ #\M)
  (defconstant +cytoplasmatic-label+ #\i)
  (defconstant +non-cytoplasmatic-label+ #\o))

(defparameter *original-tmhmm1.0* ;;performs slightly better than the proper cltmhmm
  ;;This model architecture is the same to the TMHMM 1.0, See Krogh et al. 2001
  (make-hmm-simple
   133 20 *protein-code*

   '(;;;Transmembrane

     ;;Outward chain
     ((:capin 1) #\M 0 1 ;;helix cap cytoplasmatic side ;;
      (0.0953687 0.0132852 0.000669453 0.00457821 0.101488
       0.0689898 0.00782882 0.119357 0.00398828 0.194291
       0.0256857 0.0187932 0.0155759 0.00687515 0.00852545
       0.0499541 0.0324697 0.128812 0.0380527 0.0654114))
     ((:capin 2) #\M 0 1)
     ((:capin 3) #\M 0 1)
     ((:capin 4) #\M 0 1)
     ((:capin 5) #\M 0 1)

     ((:M 1) #\M 0 1 ;;middle helix outward
      (0.105812 0.0269745 0.00240865 0.00265364 0.0950556
       0.0766579 0.00752776 0.140236 0.00263851 0.185115
       0.0423481 0.0105619 0.0206252 0.0040867 0.00135517
       0.0435658 0.0527 0.130405 0.0164475 0.0328252))
     ((:M 2) #\M 0 1)
     ((:M 3) #\M 0
      ((:M 4) .00139435 (:M 5) .00139435 (:M 6) .00139435 (:M 7) .00139435 (:M 8) .00376881 (:M 9) .00367342 (:M 10) .00217783 (:M 11) .00210595 (:M 12) .00202614 (:M 13) .00293767 (:M 14) .00195459 (:M 15) .00211136 (:M 16) .65346 (:M 17) .0458024 (:M 18) .0102859 (:M 19) .00323333 (:M 20) .256252 (:M 21) .00245723 (:M 22) .000469517 (:M 23) .000464594 (:M 24) .00124193))
     ((:M 4) #\M 0 1)
     ((:M 5) #\M 0 1)
     ((:M 6) #\M 0 1)
     ((:M 7) #\M 0 1)
     ((:M 8) #\M 0 1)
     ((:M 9) #\M 0 1)
     ((:M 10) #\M 0 1)
     ((:M 11) #\M 0 1)
     ((:M 12) #\M 0 1)
     ((:M 13) #\M 0 1)
     ((:M 14) #\M 0 1)
     ((:M 15) #\M 0 1)
     ((:M 16) #\M 0 1)
     ((:M 17) #\M 0 1)
     ((:M 18) #\M 0 1)
     ((:M 19) #\M 0 1)
     ((:M 20) #\M 0 1)
     ((:M 21) #\M 0 1)
     ((:M 22) #\M 0 1)
     ((:M 23) #\M 0 1)
     ((:M 24) #\M 0 1)
     ((:M 25) #\M 0 1)

     ((:capout 1) #\M 0 1 ;;outward helix cap non-cytoplasmatic side
      (0.107645 0.0060124 0.00480649 0.00305171 0.0942172
       0.0836349 0.00744549 0.123709 0.00245288 0.157252
       0.0503946 0.00857318 0.0253843 0.0104861 0.00379979
       0.0403377 0.0542076 0.108881 0.0482933 0.0594156))
     ((:capout 2) #\M 0 1)
     ((:capout 3) #\M 0 1)
     ((:capout 4) #\M 0 1)
     ((:capout 5) #\M 0 ((:out 1) 0.919744 (:outlong 1) 0.0802559))

     ;;Inward chain
     ((:capout 6) #\M 0 1) ;;inward helix cap non-cytoplasmatic side
     ((:capout 7) #\M 0 1)
     ((:capout 8) #\M 0 1)
     ((:capout 9) #\M 0 1)
     ((:capout 10) #\M 0 1)

     ((:M 26) #\M 0 1) ;;inward middle helix
     ((:M 27) #\M 0 1)
     ((:M 28) #\M 0
      ((:M 29) .0014 (:M 30) .0014 (:M 31) .0014 (:M 32) .0014 (:M 33) .0038 (:M 34) .0037 (:M 35) .0022 (:M 36) .0021 (:M 37) .0021 (:M 38) .003 (:M 39) .002 (:M 40) .0021 (:M 41) .6534 (:M 42) .0458 (:M 43) .0103 (:M 44) .0032 (:M 45) .2563 (:M 46) .0025 (:M 47) .0005 (:M 48) .0005 (:M 49) .0012))

     ((:M 29) #\M 0 1)
     ((:M 30) #\M 0 1)
     ((:M 31) #\M 0 1)
     ((:M 32) #\M 0 1)
     ((:M 33) #\M 0 1)
     ((:M 34) #\M 0 1)
     ((:M 35) #\M 0 1)
     ((:M 36) #\M 0 1)
     ((:M 37) #\M 0 1)
     ((:M 38) #\M 0 1)
     ((:M 39) #\M 0 1)
     ((:M 40) #\M 0 1)
     ((:M 41) #\M 0 1)
     ((:M 42) #\M 0 1)
     ((:M 43) #\M 0 1)
     ((:M 44) #\M 0 1)
     ((:M 45) #\M 0 1)
     ((:M 46) #\M 0 1)
     ((:M 47) #\M 0 1)
     ((:M 48) #\M 0 1)
     ((:M 49) #\M 0 1)
     ((:M 50) #\M 0 1)

     ((:capin 6) #\M 0 1) ;inward helix cap cytoplasmatic side
     ((:capin 7) #\M 0 1)
     ((:capin 8) #\M 0 1)
     ((:capin 9) #\M 0 1)
     ((:capin 10) #\M 0 ((:in 1) 1))


   ;;;Cytoplasmic loop
     ((:G 1) #\i 0 (:@ .985879 (:in 12) 0.0141213) ;globular
      (0.0789175 0.0199752 0.0582152 0.0731754 0.0309501
       0.0867293 0.0241595 0.0415807 0.0472946 0.0724754
       0.0179001 0.0453902 0.0632528 0.051291 0.0504971
       0.0902474 0.058244 0.0486885 0.0171029 0.0239132))

     ((:in 11) #\i 0 1 ;exiting the loop
      (0.0690174 0.0201972 0.0414314 0.0462104 0.0300471
       0.0559142 0.0225302 0.0429444 0.0904245 0.0517132
       0.0421005 0.0587728 0.039535 0.0509259 0.115182
       0.0640929 0.0652155 0.0459506 0.0148263 0.0329687))

     ((:in 12) #\i 0 1)
     ((:in 13) #\i 0 1)
     ((:in 14) #\i 0 1)
     ((:in 15) #\i 0 1)
     ((:in 16) #\i 0 1)
     ((:in 17) #\i 0 1)
     ((:in 18) #\i 0 1)
     ((:in 19) #\i 0 1)
     ((:in 20) #\i 0 ((:capin 1) 1))

     ((:in 1) #\i .54988 (:> .992299 (:in 20) .00770112 (:capin 1) 1e-10)) ;entering in the loop
     ((:in 2) #\i 0 (:> .996532 (:in 19) .00346801 (:in 20) 1.81766e-09))
     ((:in 3) #\i 0 (:> .863557 (:in 18) .136443 (:in 19) 1.45369e-08))
     ((:in 4) #\i 0 (:> .999998 (:in 17) 1.82667e-06 (:in 18) 1.94246e-07))
     ((:in 5) #\i 0 (:> .958455 (:in 16) 0.0415437 (:in 17) 9.83989e-07))
     ((:in 6) #\i 0 (:> .767851 (:in 15) .188285 (:in 16) .0438639))
     ((:in 7) #\i 0 (:> .999935 (:in 14) 3.70579e-05 (:in 15) 2.7673e-05))
     ((:in 8) #\i 0 (:> .995911 (:in 13) 9.36635e-05 (:in 14) 0.00399526))
     ((:in 9) #\i 0 (:> .96335 (:in 12)  6.92637e-05 (:in 13) 0.0365805))
     ((:in 10) #\i 0 ((:G 1) .728988 (:in 11) 0.129388 (:in 12) 0.141625))



   ;;;Non-Cytoplasmic loop short
     ((:G 2) #\o 0 (:@ .958682 (:out 11) .0413184)) ;globular

     ((:out 11) #\o 0 1  ;inward
      (0.0741433 0.0119815 0.0624066 0.0606031 0.0453262
       0.080274 0.028027 0.0257533 0.051914 0.0845635
       0.0300908 0.0516762 0.0682591 0.0380853 0.0457905
       0.078831 0.0564124 0.0510567 0.0209931 0.0338126))
     ((:out 12) #\o 0 1)
     ((:out 13) #\o 0 1)
     ((:out 14) #\o 0 1)
     ((:out 15) #\o 0 1)
     ((:out 16) #\o 0 1)
     ((:out 17) #\o 0 1)
     ((:out 18) #\o 0 1)
     ((:out 19) #\o 0 1)
     ((:out 20) #\o 0 ((:capout 6) 1))

     ((:out 1) #\o .243019 ((:capout 6) 1e-10 (:out 20) 1.60321e-07 :> 1)) ;outward
     ((:out 2) #\o 0 ((:out 20) .071321 (:out 19) .008862 :> .919817))
     ((:out 3) #\o 0 ((:out 19) .0237167 (:out 18) 5.86509e-07 :> .976283))
     ((:out 4) #\o 0 ((:out 18) 2.91541e-07 (:out 17) .125739 :> .874261))
     ((:out 5) #\o 0 ((:out 17) .0188738 (:out 16) 2.10542e-06 :> .981124))
     ((:out 6) #\o 0 ((:out 16) .128184 (:out 15) 4.02287e-06 :> .871812))
     ((:out 7) #\o 0 ((:out 15) 2.93518e-06 (:out 14) .221426 :> .778571))
     ((:out 8) #\o 0 ((:out 14) 1.89529e-06 (:out 13) 1.06328e-05 :> .999987))
     ((:out 9) #\o 0 ((:out 13) .00606352 (:out 12) .325455 :> .668481))
     ((:out 10) #\o 0 ((:out 12) 3.21153e-06 (:out 11) .0171327 (:G 2) .982864))



   ;;;Non-cytoplasmic long loop
      ((:G 3) #\o 0 (:@ 0.999041 (:outlong 11) 0.000958957)) ;globular

     ((:outlong 11) #\o 0 1 ;inward
      (0.0705222 0.0159723 0.0399057 0.0540952 0.05577
       0.0723933 0.0212929 0.0425737 0.0563806 0.103302
       0.0408011 0.0427171 0.0586852 0.0396212 0.0723275
       0.0692717 0.0558667 0.048011 0.0143902 0.0261))

     ((:outlong 12) #\o 0 1)
     ((:outlong 13) #\o 0 1)
     ((:outlong 14) #\o 0 1)
     ((:outlong 15) #\o 0 1)
     ((:outlong 16) #\o 0 1)
     ((:outlong 17) #\o 0 1)
     ((:outlong 18) #\o 0 1)
     ((:outlong 19) #\o 0 1)
     ((:outlong 20) #\o 0 ((:capout 6) 1))

     ((:outlong 1) #\o 0.207101 1 ;outward
      (0.0741433 0.0119815 0.0624066 0.0606031 0.0453262
       0.080274 0.028027 0.0257533 0.051914 0.0845635
       0.0300908 0.0516762 0.0682591 0.0380853 0.0457905
       0.078831 0.0564124 0.0510567 0.0209931 0.0338126))
     ((:outlong 2) #\o 0 1)
     ((:outlong 3) #\o 0 1)
     ((:outlong 4) #\o 0 1)
     ((:outlong 5) #\o 0 1)
     ((:outlong 6) #\o 0 1)
     ((:outlong 7) #\o 0 1)
     ((:outlong 8) #\o 0 1)
     ((:outlong 9) #\o 0 1)
     ((:outlong 10) #\o 0 ((:G 3) 1)))

   :name :tmtp
   :alphabet-type 'character))



(defparameter *cltmhmm* ;the protagonist ^^
  (MAKE-HMM-SIMPLE
   133 20
   '(#\A #\C #\D #\E #\F #\G #\H #\I #\K #\L #\M #\N #\P #\Q #\R
     #\S #\T #\V #\W #\Y)

   '(((:CAPIN 1) #\M 0.0d0 ((:CAPIN 2) 1.0d0)
      (0.10085856396530334d0 0.015397772214245717d0
       0.0043358565438133025d0 0.009836853211965169d0
       0.09249491305467682d0 0.0757519273660203d0
       0.009490257782101016d0 0.1177911265914131d0
       0.008785079339692022d0 0.1774080604415387d0
       0.033553914428466454d0 0.021136997848156612d0
       0.01981446614882334d0 0.009013545427571176d0
       0.017750660155642292d0 0.048521644271502774d0
       0.03948352465796223d0 0.11656338732190501d0
       0.0337588964429082d0 0.04825255278629268d0))
     ((:CAPIN 2) #\M 0.0d0 ((:CAPIN 3) 1.0d0))
     ((:CAPIN 3) #\M 0.0d0 ((:CAPIN 4) 1.0d0))
     ((:CAPIN 4) #\M 0.0d0 ((:CAPIN 5) 1.0d0))
     ((:CAPIN 5) #\M 0.0d0 ((:M 1) 1.0d0))
     ((:M 1) #\M 0.0d0 ((:M 2) 1.0d0)
      (0.11226675503050183d0 0.025882999884396584d0
       0.006840259272635572d0 0.006125017354204732d0
       0.08989984091724626d0 0.0837567360369973d0
       0.006311847193336192d0 0.12254254229332556d0
       0.004439798566871436d0 0.1707556442263493d0
       0.039232171032333944d0 0.015729948761916277d0
       0.027723916756472466d0 0.006695838694979828d0
       0.002828466298151103d0 0.057749092920585145d0
       0.05419161179279183d0 0.1183846155626355d0
       0.01845755536157096d0 0.030185342042697506d0))
     ((:M 2) #\M 0.0d0 ((:M 3) 1.0d0))
     ((:M 3) #\M 0.0d0
      ((:M 4) 7.120642540632079d-13 (:M 5) 9.778942319706775d-13
       (:M 6) 0.006089004089293317d0 (:M 7) 7.308097272307812d-13
       (:M 8) 7.47631488294444d-13 (:M 9) 6.109063672558964d-13
       (:M 10) 1.9696753784982154d-9 (:M 11)
       0.009140141753508243d0 (:M 12) 0.017301645425237683d0
       (:M 13) 2.327670849476774d-7 (:M 14)
       0.0036361759406678333d0 (:M 15) 0.1641124701613746d0
       (:M 16) 0.15931551497455704d0 (:M 17)
       0.16279410569189526d0 (:M 18) 0.09720714817694528d0
       (:M 19) 0.03833244361314774d0 (:M 20) 0.29845918444019d0
       (:M 21) 0.04325128553450278d0 (:M 22)
       1.5823115427575741d-12 (:M 23) 7.773975598899221d-13
       (:M 24) 3.606454557815618d-4))
     ((:M 4) #\M 0.0d0 ((:M 5) 1.0d0))
     ((:M 5) #\M 0.0d0 ((:M 6) 1.0d0))
     ((:M 6) #\M 0.0d0 ((:M 7) 1.0d0))
     ((:M 7) #\M 0.0d0 ((:M 8) 1.0d0))
     ((:M 8) #\M 0.0d0 ((:M 9) 1.0d0))
     ((:M 9) #\M 0.0d0 ((:M 10) 1.0d0))
     ((:M 10) #\M 0.0d0 ((:M 11) 1.0d0))
     ((:M 11) #\M 0.0d0 ((:M 12) 1.0d0))
     ((:M 12) #\M 0.0d0 ((:M 13) 1.0d0))
     ((:M 13) #\M 0.0d0 ((:M 14) 1.0d0))
     ((:M 14) #\M 0.0d0 ((:M 15) 1.0d0))
     ((:M 15) #\M 0.0d0 ((:M 16) 1.0d0))
     ((:M 16) #\M 0.0d0 ((:M 17) 1.0d0))
     ((:M 17) #\M 0.0d0 ((:M 18) 1.0d0))
     ((:M 18) #\M 0.0d0 ((:M 19) 1.0d0))
     ((:M 19) #\M 0.0d0 ((:M 20) 1.0d0))
     ((:M 20) #\M 0.0d0 ((:M 21) 1.0d0))
     ((:M 21) #\M 0.0d0 ((:M 22) 1.0d0))
     ((:M 22) #\M 0.0d0 ((:M 23) 1.0d0))
     ((:M 23) #\M 0.0d0 ((:M 24) 1.0d0))
     ((:M 24) #\M 0.0d0 ((:M 25) 1.0d0))
     ((:M 25) #\M 0.0d0 ((:CAPOUT 1) 1.0d0))
     ((:CAPOUT 1) #\M 0.0d0 ((:CAPOUT 2) 1.0d0)
      (0.10458507697804141d0 0.00918416818378012d0
       0.009885390897718517d0 0.009116957948476365d0
       0.08955266529190353d0 0.08767616365979061d0
       0.010487257604996284d0 0.11450167753425769d0
       0.004793362569347243d0 0.14495905773847476d0
       0.04307138820848401d0 0.017531177148770182d0
       0.030690418323428455d0 0.014644354846210107d0
       0.007263967609233867d0 0.04845626811838122d0
       0.0534327457482494d0 0.1025825919962399d0
       0.04165957609296089d0 0.05592573350125506d0))
     ((:CAPOUT 2) #\M 0.0d0 ((:CAPOUT 3) 1.0d0))
     ((:CAPOUT 3) #\M 0.0d0 ((:CAPOUT 4) 1.0d0))
     ((:CAPOUT 4) #\M 0.0d0 ((:CAPOUT 5) 1.0d0))
     ((:CAPOUT 5) #\M 0.0d0
      ((:OUT 1) 0.8367443019622565d0 (:OUTLONG 1)
       0.16325569803774315d0))
     ((:CAPOUT 6) #\M 0.0d0 ((:CAPOUT 7) 1.0d0))
     ((:CAPOUT 7) #\M 0.0d0 ((:CAPOUT 8) 1.0d0))
     ((:CAPOUT 8) #\M 0.0d0 ((:CAPOUT 9) 1.0d0))
     ((:CAPOUT 9) #\M 0.0d0 ((:CAPOUT 10) 1.0d0))
     ((:CAPOUT 10) #\M 0.0d0 ((:M 26) 1.0d0))
     ((:M 26) #\M 0.0d0 ((:M 27) 1.0d0))
     ((:M 27) #\M 0.0d0 ((:M 28) 1.0d0))
     ((:M 28) #\M 0.0d0
      ((:M 29) 3.851077163144211d-13 (:M 30)
       5.008093450799801d-13 (:M 31) 1.365606558522574d-8 (:M 32)
       2.1894649141228855d-9 (:M 33) 0.017643996833199636d0
       (:M 34) 0.004458615644726062d0 (:M 35)
       0.0019151355187164184d0 (:M 36) 0.02470917771218736d0
       (:M 37) 0.012781881884553684d0 (:M 38)
       0.020919692102119546d0 (:M 39) 0.051662399958321815d0
       (:M 40) 1.541671766320178d-4 (:M 41) 0.21040983198504679d0
       (:M 42) 0.2578019563129475d0 (:M 43) 0.10149434050914662d0
       (:M 44) 0.0018453887533443083d0 (:M 45)
       0.2847979852583462d0 (:M 46) 2.16160606304004d-9 (:M 47)
       2.3814037538719917d-12 (:M 48) 1.1265064867043511d-10
       (:M 49) 0.009405412227658876d0))
     ((:M 29) #\M 0.0d0 ((:M 30) 1.0d0))
     ((:M 30) #\M 0.0d0 ((:M 31) 1.0d0))
     ((:M 31) #\M 0.0d0 ((:M 32) 1.0d0))
     ((:M 32) #\M 0.0d0 ((:M 33) 1.0d0))
     ((:M 33) #\M 0.0d0 ((:M 34) 1.0d0))
     ((:M 34) #\M 0.0d0 ((:M 35) 1.0d0))
     ((:M 35) #\M 0.0d0 ((:M 36) 1.0d0))
     ((:M 36) #\M 0.0d0 ((:M 37) 1.0d0))
     ((:M 37) #\M 0.0d0 ((:M 38) 1.0d0))
     ((:M 38) #\M 0.0d0 ((:M 39) 1.0d0))
     ((:M 39) #\M 0.0d0 ((:M 40) 1.0d0))
     ((:M 40) #\M 0.0d0 ((:M 41) 1.0d0))
     ((:M 41) #\M 0.0d0 ((:M 42) 1.0d0))
     ((:M 42) #\M 0.0d0 ((:M 43) 1.0d0))
     ((:M 43) #\M 0.0d0 ((:M 44) 1.0d0))
     ((:M 44) #\M 0.0d0 ((:M 45) 1.0d0))
     ((:M 45) #\M 0.0d0 ((:M 46) 1.0d0))
     ((:M 46) #\M 0.0d0 ((:M 47) 1.0d0))
     ((:M 47) #\M 0.0d0 ((:M 48) 1.0d0))
     ((:M 48) #\M 0.0d0 ((:M 49) 1.0d0))
     ((:M 49) #\M 0.0d0 ((:M 50) 1.0d0))
     ((:M 50) #\M 0.0d0 ((:CAPIN 6) 1.0d0))
     ((:CAPIN 6) #\M 0.0d0 ((:CAPIN 7) 1.0d0))
     ((:CAPIN 7) #\M 0.0d0 ((:CAPIN 8) 1.0d0))
     ((:CAPIN 8) #\M 0.0d0 ((:CAPIN 9) 1.0d0))
     ((:CAPIN 9) #\M 0.0d0 ((:CAPIN 10) 1.0d0))
     ((:CAPIN 10) #\M 0.0d0 ((:IN 1) 1.0d0))
     ((:G 1) #\i 0.0d0
      ((:G 1) 0.9874585614088749d0 (:IN 12)
       0.012541438591125335d0)
      (0.07047983543581002d0 0.021248031755132506d0
       0.05697345184978159d0 0.06701196728347711d0
       0.03541985296599335d0 0.07036657773373703d0
       0.02203556358582789d0 0.04543527223549146d0
       0.05157407491505262d0 0.08813161675885149d0
       0.021246567312374266d0 0.047579499093597113d0
       0.05786075358349577d0 0.04320641697769528d0
       0.05592774123121476d0 0.0723157503699985d0
       0.06036847824530896d0 0.06360182796392984d0
       0.01618949186837217d0 0.03302722883485831d0))
     ((:IN 11) #\i 0.0d0 ((:IN 12) 1.0d0)
      (0.07399478089639615d0 0.017183216954192303d0
       0.03569245006524268d0 0.04316096867373482d0
       0.04189696165641605d0 0.05687280427828474d0
       0.021733691363691732d0 0.05325685391085805d0
       0.09011606747468175d0 0.07532147716298768d0
       0.04093602603898687d0 0.04781472605246872d0
       0.035952697443815455d0 0.04328162426165205d0
       0.10440421617566815d0 0.05859748972791743d0
       0.05683295615586232d0 0.05355107673298199d0
       0.016711944960381503d0 0.03268797001377889d0))
     ((:IN 12) #\i 0.0d0 ((:IN 13) 1.0d0))
     ((:IN 13) #\i 0.0d0 ((:IN 14) 1.0d0))
     ((:IN 14) #\i 0.0d0 ((:IN 15) 1.0d0))
     ((:IN 15) #\i 0.0d0 ((:IN 16) 1.0d0))
     ((:IN 16) #\i 0.0d0 ((:IN 17) 1.0d0))
     ((:IN 17) #\i 0.0d0 ((:IN 18) 1.0d0))
     ((:IN 18) #\i 0.0d0 ((:IN 19) 1.0d0))
     ((:IN 19) #\i 0.0d0 ((:IN 20) 1.0d0))
     ((:IN 20) #\i 0.0d0 ((:CAPIN 1) 1.0d0))
     ((:IN 1) #\i 0.5500000000000003d0
      ((:CAPIN 1) 7.215324755532862d-7 (:IN 20)
       0.010217333116888513d0 (:IN 2) 0.9897819453506361d0))
     ((:IN 2) #\i 0.0d0
      ((:IN 19) 0.01376598969611768d0 (:IN 20)
       1.5243221574354673d-11 (:IN 3) 0.9862340102886389d0))
     ((:IN 3) #\i 0.0d0
      ((:IN 18) 0.08053981628250784d0 (:IN 19)
       2.494035324537485d-8 (:IN 4) 0.9194601587771388d0))
     ((:IN 4) #\i 0.0d0
      ((:IN 17) 0.011646569919328466d0 (:IN 18)
       0.022212525675227038d0 (:IN 5) 0.9661409044054446d0))
     ((:IN 5) #\i 0.0d0
      ((:IN 16) 0.018701296366125574d0 (:IN 17)
       4.0121799365585106d-4 (:IN 6) 0.9808974856402182d0))
     ((:IN 6) #\i 0.0d0
      ((:IN 15) 0.024796622562558872d0 (:IN 16)
       0.15278538584213808d0 (:IN 7) 0.8224179915953022d0))
     ((:IN 7) #\i 0.0d0
      ((:IN 14) 0.017542592702054816d0 (:IN 15)
       0.08604429873283498d0 (:IN 8) 0.8964131085651088d0))
     ((:IN 8) #\i 0.0d0
      ((:IN 13) 3.7725633126424566d-8 (:IN 14)
       0.020854991253686977d0 (:IN 9) 0.9791449710206805d0))
     ((:IN 9) #\i 0.0d0
      ((:IN 12) 7.680360563208614d-11 (:IN 13)
       0.06859169417072955d0 (:IN 10) 0.9314083057524672d0))
     ((:IN 10) #\i 0.0d0
      ((:G 1) 0.8314862898245319d0 (:IN 11) 0.16815901276129308d0
       (:IN 12) 3.546974141753737d-4))
     ((:G 2) #\o 0.0d0
      ((:G 2) 0.9165902365444694d0 (:OUT 11)
       0.0834097634555303d0))
     ((:OUT 11) #\o 0.0d0 ((:OUT 12) 1.0d0)
      (0.0762128552597675d0 0.013624774205852118d0
       0.04921902078330273d0 0.04660804089051032d0
       0.056157052975809474d0 0.08482575683950272d0
       0.029374578908841827d0 0.040320536049837805d0
       0.036396699824175156d0 0.0926721060444096d0
       0.03337579912778661d0 0.04641839610231275d0
       0.06035798288130703d0 0.03884945457175218d0
       0.036659577504229914d0 0.0721833044167684d0
       0.05539280202845555d0 0.059896588049969904d0
       0.02531089623643354d0 0.04614377729897503d0))
     ((:OUT 12) #\o 0.0d0 ((:OUT 13) 1.0d0))
     ((:OUT 13) #\o 0.0d0 ((:OUT 14) 1.0d0))
     ((:OUT 14) #\o 0.0d0 ((:OUT 15) 1.0d0))
     ((:OUT 15) #\o 0.0d0 ((:OUT 16) 1.0d0))
     ((:OUT 16) #\o 0.0d0 ((:OUT 17) 1.0d0))
     ((:OUT 17) #\o 0.0d0 ((:OUT 18) 1.0d0))
     ((:OUT 18) #\o 0.0d0 ((:OUT 19) 1.0d0))
     ((:OUT 19) #\o 0.0d0 ((:OUT 20) 1.0d0))
     ((:OUT 20) #\o 0.0d0 ((:CAPOUT 6) 1.0d0))
     ((:OUT 1) #\o 0.15883240111411878d0
      ((:CAPOUT 6) 4.20366351606448d-13 (:OUT 20)
       9.966319391141372d-13 (:OUT 2) 0.9999999999985831d0))
     ((:OUT 2) #\o 0.0d0
      ((:OUT 19) 0.07506071739720196d0 (:OUT 20)
       0.048145401378141314d0 (:OUT 3) 0.8767938812246574d0))
     ((:OUT 3) #\o 0.0d0
      ((:OUT 18) 5.176011372568072d-10 (:OUT 19)
       4.6101836373730225d-6 (:OUT 4) 0.9999953892987621d0))
     ((:OUT 4) #\o 0.0d0
      ((:OUT 17) 0.12129378482880747d0 (:OUT 18)
       4.9714765580963064d-5 (:OUT 5) 0.8786565004056115d0))
     ((:OUT 5) #\o 0.0d0
      ((:OUT 16) 0.0014033414882639085d0 (:OUT 17)
       0.0636327281592476d0 (:OUT 6) 0.9349639303524884d0))
     ((:OUT 6) #\o 0.0d0
      ((:OUT 15) 1.2824916483532091d-4 (:OUT 16)
       0.184204808593637d0 (:OUT 7) 0.8156669422415284d0))
     ((:OUT 7) #\o 0.0d0
      ((:OUT 14) 0.21885148374081992d0 (:OUT 15)
       0.005144837702106449d0 (:OUT 8) 0.7760036785570742d0))
     ((:OUT 8) #\o 0.0d0
      ((:OUT 13) 4.13590511173537d-8 (:OUT 14)
       8.561160365925839d-4 (:OUT 9) 0.9991438426043566d0))
     ((:OUT 9) #\o 0.0d0
      ((:OUT 12) 7.415894969496017d-7 (:OUT 13)
       0.19067860064705636d0 (:OUT 10) 0.809320657763447d0))
     ((:OUT 10) #\o 0.0d0
      ((:G 2) 0.8305636994754351d0 (:OUT 11)
       0.16943471361964296d0 (:OUT 12) 1.5869049219089963d-6))
     ((:G 3) #\o 0.0d0
      ((:G 3) 0.9972706662064559d0 (:OUTLONG 11)
       0.0027293337935443175d0))
     ((:OUTLONG 11) #\o 0.0d0 ((:OUTLONG 12) 1.0d0)
      (0.06012337329986307d0 0.01431277796186581d0
       0.04053089728739874d0 0.05802272315618818d0
       0.056644257735488146d0 0.06311244769627174d0
       0.021026234029342547d0 0.04650451902457646d0
       0.05099567743006938d0 0.10917866777859173d0
       0.047179018959486216d0 0.03824033090313002d0
       0.06016695927569584d0 0.043262101645581086d0
       0.06030969811713666d0 0.08353671163842846d0
       0.05168828090623906d0 0.05343441919158612d0
       0.01764453194978742d0 0.024086372013273048d0))
     ((:OUTLONG 12) #\o 0.0d0 ((:OUTLONG 13) 1.0d0))
     ((:OUTLONG 13) #\o 0.0d0 ((:OUTLONG 14) 1.0d0))
     ((:OUTLONG 14) #\o 0.0d0 ((:OUTLONG 15) 1.0d0))
     ((:OUTLONG 15) #\o 0.0d0 ((:OUTLONG 16) 1.0d0))
     ((:OUTLONG 16) #\o 0.0d0 ((:OUTLONG 17) 1.0d0))
     ((:OUTLONG 17) #\o 0.0d0 ((:OUTLONG 18) 1.0d0))
     ((:OUTLONG 18) #\o 0.0d0 ((:OUTLONG 19) 1.0d0))
     ((:OUTLONG 19) #\o 0.0d0 ((:OUTLONG 20) 1.0d0))
     ((:OUTLONG 20) #\o 0.0d0 ((:CAPOUT 6) 1.0d0))
     ((:OUTLONG 1) #\o 0.2911675988858807d0 ((:OUTLONG 2) 1.0d0))
     ((:OUTLONG 2) #\o 0.0d0 ((:OUTLONG 3) 1.0d0))
     ((:OUTLONG 3) #\o 0.0d0 ((:OUTLONG 4) 1.0d0))
     ((:OUTLONG 4) #\o 0.0d0 ((:OUTLONG 5) 1.0d0))
     ((:OUTLONG 5) #\o 0.0d0 ((:OUTLONG 6) 1.0d0))
     ((:OUTLONG 6) #\o 0.0d0 ((:OUTLONG 7) 1.0d0))
     ((:OUTLONG 7) #\o 0.0d0 ((:OUTLONG 8) 1.0d0))
     ((:OUTLONG 8) #\o 0.0d0 ((:OUTLONG 9) 1.0d0))
     ((:OUTLONG 9) #\o 0.0d0 ((:OUTLONG 10) 1.0d0))
     ((:OUTLONG 10) #\o 0.0d0 ((:G 3) 1.0d0)))
   :NAME NIL :ALPHABET-TYPE 'CHARACTER :MODEL-SPEC :RELEVANT))



;; (defparameter *tmmod* ;;an improvement?
;;   (make-hmm-simple
;;    153 20 *protein-code*

;;    '(;;;Transmembrane

;;      ;;Outward chain
;;      ((:capin 1) #\M 0 1 ;;helix cap cytoplasmatic side
;;       (0.0953687 0.0132852 0.000669453 0.00457821 0.101488
;;        0.0689898 0.00782882 0.119357 0.00398828 0.194291
;;        0.0256857 0.0187932 0.0155759 0.00687515 0.00852545
;;        0.0499541 0.0324697 0.128812 0.0380527 0.0654114))
;;      ((:capin 2) #\M 0 1)
;;      ((:capin 3) #\M 0 1)
;;      ((:capin 4) #\M 0 1)
;;      ((:capin 5) #\M 0 1)

;;      ((:M 1) #\M 0 1 ;;middle helix outward
;;       (0.105812 0.0269745 0.00240865 0.00265364 0.0950556
;;        0.0766579 0.00752776 0.140236 0.00263851 0.185115
;;        0.0423481 0.0105619 0.0206252 0.0040867 0.00135517
;;        0.0435658 0.0527 0.130405 0.0164475 0.0328252))
;;      ((:M 2) #\M 0 1)
;;      ((:M 3) #\M 0
;;       ((:M 4) .00139435 (:M 5) .00139435 (:M 6) .00139435 (:M 7) .00139435 (:M 8) .00376881 (:M 9) .00367342 (:M 10) .00217783 (:M 11) .00210595 (:M 12) .00202614 (:M 13) .00293767 (:M 14) .00195459 (:M 15) .00211136 (:M 16) .65346 (:M 17) .0458024 (:M 18) .0102859 (:M 19) .00323333 (:M 20) .256252 (:M 21) .00245723 (:M 22) .000469517 (:M 23) .000464594 (:M 24) .00124193))
;;      ((:M 4) #\M 0 1)
;;      ((:M 5) #\M 0 1)
;;      ((:M 6) #\M 0 1)
;;      ((:M 7) #\M 0 1)
;;      ((:M 8) #\M 0 1)
;;      ((:M 9) #\M 0 1)
;;      ((:M 10) #\M 0 1)
;;      ((:M 11) #\M 0 1)
;;      ((:M 12) #\M 0 1)
;;      ((:M 13) #\M 0 1)
;;      ((:M 14) #\M 0 1)
;;      ((:M 15) #\M 0 1)
;;      ((:M 16) #\M 0 1)
;;      ((:M 17) #\M 0 1)
;;      ((:M 18) #\M 0 1)
;;      ((:M 19) #\M 0 1)
;;      ((:M 20) #\M 0 1)
;;      ((:M 21) #\M 0 1)
;;      ((:M 22) #\M 0 1)
;;      ((:M 23) #\M 0 1)
;;      ((:M 24) #\M 0 1)
;;      ((:M 25) #\M 0 1)

;;      ((:capout 1) #\M 0 1 ;;outward helix cap non-cytoplasmatic side
;;       (0.107645 0.0060124 0.00480649 0.00305171 0.0942172
;;        0.0836349 0.00744549 0.123709 0.00245288 0.157252
;;        0.0503946 0.00857318 0.0253843 0.0104861 0.00379979
;;        0.0403377 0.0542076 0.108881 0.0482933 0.0594156))
;;      ((:capout 2) #\M 0 1)
;;      ((:capout 3) #\M 0 1)
;;      ((:capout 4) #\M 0 1)
;;      ((:capout 5) #\M 0 ((:out 1) 0.5 (:out 21) 0.42 (:outlong 1) 0.0802559))

;;      ;;Inward chain
;;      ((:capout 6) #\M 0 1) ;;inward helix cap non-cytoplasmatic side
;;      ((:capout 7) #\M 0 1)
;;      ((:capout 8) #\M 0 1)
;;      ((:capout 9) #\M 0 1)
;;      ((:capout 10) #\M 0 1)

;;      ((:M 26) #\M 0 1) ;;inward middle helix
;;      ((:M 27) #\M 0 1)
;;      ((:M 28) #\M 0
;;       ((:M 29) .0014 (:M 30) .0014 (:M 31) .0014 (:M 32) .0014 (:M 33) .0038 (:M 34) .0037 (:M 35) .0022 (:M 36) .0021 (:M 37) .0021 (:M 38) .003 (:M 39) .002 (:M 40) .0021 (:M 41) .6534 (:M 42) .0458 (:M 43) .0103 (:M 44) .0032 (:M 45) .2563 (:M 46) .0025 (:M 47) .0005 (:M 48) .0005 (:M 49) .0012))

;;      ((:M 29) #\M 0 1)
;;      ((:M 30) #\M 0 1)
;;      ((:M 31) #\M 0 1)
;;      ((:M 32) #\M 0 1)
;;      ((:M 33) #\M 0 1)
;;      ((:M 34) #\M 0 1)
;;      ((:M 35) #\M 0 1)
;;      ((:M 36) #\M 0 1)
;;      ((:M 37) #\M 0 1)
;;      ((:M 38) #\M 0 1)
;;      ((:M 39) #\M 0 1)
;;      ((:M 40) #\M 0 1)
;;      ((:M 41) #\M 0 1)
;;      ((:M 42) #\M 0 1)
;;      ((:M 43) #\M 0 1)
;;      ((:M 44) #\M 0 1)
;;      ((:M 45) #\M 0 1)
;;      ((:M 46) #\M 0 1)
;;      ((:M 47) #\M 0 1)
;;      ((:M 48) #\M 0 1)
;;      ((:M 49) #\M 0 1)
;;      ((:M 50) #\M 0 1)

;;      ((:capin 6) #\M 0 1) ;inward helix cap cytoplasmatic side
;;      ((:capin 7) #\M 0 1)
;;      ((:capin 8) #\M 0 1)
;;      ((:capin 9) #\M 0 1)
;;      ((:capin 10) #\M 0 ((:in 1) .67 (:in 21) .33))


;;    ;;;Cytoplasmic loop
;;      ((:G 1) #\i 0 (:@ .985879 (:in 12) 0.0141213) ;globular
;;       (0.0789175 0.0199752 0.0582152 0.0731754 0.0309501
;;        0.0867293 0.0241595 0.0415807 0.0472946 0.0724754
;;        0.0179001 0.0453902 0.0632528 0.051291 0.0504971
;;        0.0902474 0.058244 0.0486885 0.0171029 0.0239132))

;;      ((:in 11) #\i 0 1 ;exiting the loop
;;       (0.0690174 0.0201972 0.0414314 0.0462104 0.0300471
;;        0.0559142 0.0225302 0.0429444 0.0904245 0.0517132
;;        0.0421005 0.0587728 0.039535 0.0509259 0.115182
;;        0.0640929 0.0652155 0.0459506 0.0148263 0.0329687))

;;      ((:in 12) #\i 0 1)
;;      ((:in 13) #\i 0 1)
;;      ((:in 14) #\i 0 1)
;;      ((:in 15) #\i 0 1)
;;      ((:in 16) #\i 0 1)
;;      ((:in 17) #\i 0 1)
;;      ((:in 18) #\i 0 1)
;;      ((:in 19) #\i 0 1)
;;      ((:in 20) #\i 0 ((:capin 1) 1))

;;      ((:in 1) #\i .54988 (:> .992299 (:in 20) .00770112 (:capin 1) 1e-10)) ;entering in the loop
;;      ((:in 2) #\i 0 (:> .996532 (:in 19) .00346801 (:in 20) 1.81766e-09))
;;      ((:in 3) #\i 0 (:> .863557 (:in 18) .136443 (:in 19) 1.45369e-08))
;;      ((:in 4) #\i 0 (:> .999998 (:in 17) 1.82667e-06 (:in 18) 1.94246e-07))
;;      ((:in 5) #\i 0 (:> .958455 (:in 16) 0.0415437 (:in 17) 9.83989e-07))
;;      ((:in 6) #\i 0 (:> .767851 (:in 15) .188285 (:in 16) .0438639))
;;      ((:in 7) #\i 0 (:> .999935 (:in 14) 3.70579e-05 (:in 15) 2.7673e-05))
;;      ((:in 8) #\i 0 (:> .995911 (:in 13) 9.36635e-05 (:in 14) 0.00399526))
;;      ((:in 9) #\i 0 (:> .96335 (:in 12)  6.92637e-05 (:in 13) 0.0365805))
;;      ((:in 10) #\i 0 ((:G 1) .728988 (:in 11) 0.129388 (:in 12) 0.141625))

;;      ((:in 21) #\i 0 1)
;;      ((:in 22) #\i 0 1)
;;      ((:in 23) #\i 0 1)
;;      ((:in 24) #\i 0 1)
;;      ((:in 25) #\i 0 1)
;;      ((:in 26) #\i 0 1)
;;      ((:in 27) #\i 0 1)
;;      ((:in 28) #\i 0 1)
;;      ((:in 29) #\i 0 1)
;;      ((:in 30) #\i 0 ((:G 1) 1))



;;    ;;;Non-Cytoplasmic loop short
;;      ((:G 2) #\o 0 (:@ .958682 (:out 11) .0413184)) ;globular

;;      ((:out 11) #\o 0 1  ;inward
;;       (0.0741433 0.0119815 0.0624066 0.0606031 0.0453262
;;        0.080274 0.028027 0.0257533 0.051914 0.0845635
;;        0.0300908 0.0516762 0.0682591 0.0380853 0.0457905
;;        0.078831 0.0564124 0.0510567 0.0209931 0.0338126))
;;      ((:out 12) #\o 0 1)
;;      ((:out 13) #\o 0 1)
;;      ((:out 14) #\o 0 1)
;;      ((:out 15) #\o 0 1)
;;      ((:out 16) #\o 0 1)
;;      ((:out 17) #\o 0 1)
;;      ((:out 18) #\o 0 1)
;;      ((:out 19) #\o 0 1)
;;      ((:out 20) #\o 0 ((:capout 6) 1))

;;      ((:out 1) #\o .243019 ((:capout 6) 1e-10 (:out 20) 1.60321e-07 :> 1)) ;outward
;;      ((:out 2) #\o 0 ((:out 20) .071321 (:out 19) .008862 :> .919817))
;;      ((:out 3) #\o 0 ((:out 19) .0237167 (:out 18) 5.86509e-07 :> .976283))
;;      ((:out 4) #\o 0 ((:out 18) 2.91541e-07 (:out 17) .125739 :> .874261))
;;      ((:out 5) #\o 0 ((:out 17) .0188738 (:out 16) 2.10542e-06 :> .981124))
;;      ((:out 6) #\o 0 ((:out 16) .128184 (:out 15) 4.02287e-06 :> .871812))
;;      ((:out 7) #\o 0 ((:out 15) 2.93518e-06 (:out 14) .221426 :> .778571))
;;      ((:out 8) #\o 0 ((:out 14) 1.89529e-06 (:out 13) 1.06328e-05 :> .999987))
;;      ((:out 9) #\o 0 ((:out 13) .00606352 (:out 12) .325455 :> .668481))
;;      ((:out 10) #\o 0 ((:out 12) 3.21153e-06 (:out 11) .0171327 (:G 2) .982864))

;;      ((:out 21) #\o 0 1)
;;      ((:out 22) #\o 0 1)
;;      ((:out 23) #\o 0 1)
;;      ((:out 24) #\o 0 1)
;;      ((:out 25) #\o 0 1)
;;      ((:out 26) #\o 0 1)
;;      ((:out 27) #\o 0 1)
;;      ((:out 28) #\o 0 1)
;;      ((:out 29) #\o 0 1)
;;      ((:out 30) #\o 0 ((:G 2) 1))


;;    ;;;Non-cytoplasmic long loop
;;       ((:G 3) #\o 0 (:@ 0.999041 (:outlong 11) 0.000958957)) ;globular

;;      ((:outlong 11) #\o 0 1 ;inward
;;       (0.0705222 0.0159723 0.0399057 0.0540952 0.05577
;;        0.0723933 0.0212929 0.0425737 0.0563806 0.103302
;;        0.0408011 0.0427171 0.0586852 0.0396212 0.0723275
;;        0.0692717 0.0558667 0.048011 0.0143902 0.0261))

;;      ((:outlong 12) #\o 0 1)
;;      ((:outlong 13) #\o 0 1)
;;      ((:outlong 14) #\o 0 1)
;;      ((:outlong 15) #\o 0 1)
;;      ((:outlong 16) #\o 0 1)
;;      ((:outlong 17) #\o 0 1)
;;      ((:outlong 18) #\o 0 1)
;;      ((:outlong 19) #\o 0 1)
;;      ((:outlong 20) #\o 0 ((:capout 6) 1))

;;      ((:outlong 1) #\o 0.207101 1 ;outward
;;       (0.0741433 0.0119815 0.0624066 0.0606031 0.0453262
;;        0.080274 0.028027 0.0257533 0.051914 0.0845635
;;        0.0300908 0.0516762 0.0682591 0.0380853 0.0457905
;;        0.078831 0.0564124 0.0510567 0.0209931 0.0338126))
;;      ((:outlong 2) #\o 0 1)
;;      ((:outlong 3) #\o 0 1)
;;      ((:outlong 4) #\o 0 1)
;;      ((:outlong 5) #\o 0 1)
;;      ((:outlong 6) #\o 0 1)
;;      ((:outlong 7) #\o 0 1)
;;      ((:outlong 8) #\o 0 1)
;;      ((:outlong 9) #\o 0 1)
;;      ((:outlong 10) #\o 0 ((:G 3) 1)))


;;    :name :tmtp
;;    :alphabet-type 'character))


